<mat-dialog-content>
  <mat-card class="add-product">
    <mat-card-header>
      <mat-card-title>List a New Product</mat-card-title>
      <mat-card-subtitle
        >Fill in the details to add your product to the
        marketplace</mat-card-subtitle
      >
    </mat-card-header>
    <mat-card-content>
      <form (ngSubmit)="addProduct()">
        <!-- Basic Information Section -->
        <div class="form-section">
          <div class="section-title">
            <mat-icon>info</mat-icon> Basic Information
          </div>
          <div class="form-row">
            <div class="form-col">
              <mat-form-field appearance="outline" class="full-width">
                <mat-label>Product Name</mat-label>
                <input
                  matInput
                  type="text"
                  [(ngModel)]="newProduct.name"
                  name="name"
                  required
                />
                <mat-icon matSuffix>shopping_bag</mat-icon>
              </mat-form-field>
            </div>
            <div class="form-col">
              <mat-form-field appearance="outline" class="full-width">
                <mat-label>Category</mat-label>
                <mat-select
                  [(ngModel)]="newProduct.category"
                  name="category"
                  required
                >
                  <mat-option
                    *ngFor="let category of categories"
                    [value]="category"
                  >
                    {{ category }}
                  </mat-option>
                </mat-select>
                <mat-icon matSuffix>category</mat-icon>
              </mat-form-field>
            </div>
          </div>

          <mat-form-field appearance="outline" class="full-width">
            <mat-label>Description</mat-label>
            <textarea
              matInput
              [(ngModel)]="newProduct.description"
              name="description"
              required
              rows="4"
              placeholder="Describe your product in detail..."
            ></textarea>
            <mat-icon matSuffix>description</mat-icon>
          </mat-form-field>
        </div>

        <!-- Pricing & Inventory Section -->
        <div class="form-section">
          <div class="section-title">
            <mat-icon>attach_money</mat-icon> Pricing & Inventory
          </div>
          <div class="form-row">
            <div class="form-col">
              <mat-form-field appearance="outline" class="full-width">
                <mat-label>Price</mat-label>
                <input
                  matInput
                  type="number"
                  [(ngModel)]="newProduct.price"
                  name="price"
                  required
                  min="0"
                  step="0.01"
                />
                <span matPrefix>$ </span>
                <mat-icon matSuffix>monetization_on</mat-icon>
              </mat-form-field>
            </div>
            <div class="form-col">
              <mat-form-field appearance="outline" class="full-width">
                <mat-label>Total Inventory</mat-label>
                <input
                  matInput
                  type="number"
                  [(ngModel)]="newProduct.inventory.total"
                  name="inventory"
                  required
                  min="1"
                  step="1"
                />
                <mat-icon matSuffix>inventory_2</mat-icon>
              </mat-form-field>
            </div>
          </div>
        </div>

        <!-- Location Section -->
        <div class="form-section">
          <div class="section-title">
            <mat-icon>location_on</mat-icon> Location
          </div>
          <mat-form-field appearance="outline" class="full-width">
            <mat-label>Location</mat-label>
            <input
              matInput
              type="text"
              [(ngModel)]="newProduct.location"
              name="location"
              required
              placeholder="Where is this product available?"
            />
            <mat-icon matSuffix>place</mat-icon>
          </mat-form-field>
        </div>

        <!-- Images Section -->
        <div class="form-section">
          <div class="section-title">
            <mat-icon>image</mat-icon> Product Images
          </div>
          <div class="image-upload-container">
            <button
              mat-stroked-button
              type="button"
              (click)="fileInput.click()"
              class="btn btn-secondary"
            >
              <mat-icon>cloud_upload</mat-icon> Upload Images
            </button>
            <input
              hidden
              type="file"
              #fileInput
              (change)="onFilesSelected($event)"
              accept="image/*"
              multiple
            />

            <div class="image-preview-container" *ngIf="previewUrls.length > 0">
              <div
                class="image-preview"
                *ngFor="let url of previewUrls; let i = index"
              >
                <img [src]="url" alt="Product preview" />
                <div class="remove-image" (click)="removeSelectedImage(i)">
                  <mat-icon>close</mat-icon>
                </div>
              </div>
            </div>

            <div *ngIf="previewUrls.length > 0" class="selected-files-info">
              {{ previewUrls.length }} image(s) selected
            </div>
          </div>
        </div>
      </form>
    </mat-card-content>
  </mat-card>
</mat-dialog-content>

<mat-dialog-actions align="end">
  <button mat-button (click)="onCancel()">Cancel</button>
  <button
    mat-raised-button
    color="primary"
    (click)="addProduct()"
    [disabled]="isLoading"
  >
    <mat-icon>add_circle</mat-icon> Add Product
  </button>
</mat-dialog-actions>
